# apexofficeprint-python
This project provides a Python interface for APEX Office Print.

# Installation
In your terminal:

TODO: `pip install apexofficeprint`

You also need to have the requests-library installed (https://docs.python-requests.org/en/master/). This can be installed in your terminal:
`pip install requests`

# Usage
1. Create a template (docx, xlsx, pptx, HTML, md, txt, csv)
2. Create the input data with this Python SDK
3. Send template and data to an AOP server and save the response to a file with this Python SDK

For an overview of all the possibilities, we refer to the official AOP docs: http://www.apexofficeprint.com/docs/.

To see the JSON-data that is sent to the AOP server, you can turn on verbose-mode by running your Python program with the `--verbose` argument like this:
```python
python my_file.py --verbose
```

# Quickstart: Hello World example
## Template (docx)
<img src="./imgs/hello_world_template.png" width="600" />

## Data
The data can be generated by the Python SDK:
```python
import apexofficeprint as aop

# Main object that holds the data
collection = aop.elements.ElementCollection()

# Create the title element and add it to the element collection
title = aop.elements.Property(
    name='title',
    value='Hello World!'
)
collection.add(title)

# Create the text element and add it to the element collection
text = aop.elements.Property(
    name='text',
    value='This is an example created with the AOP Python SDK'
)
collection.add(text)
...
```

## AOP server
The template and the data need to be sent to an AOP server that merges both. This can be done by setting up the AOP server and creating a printjob in the same Python file:
```python
...
SERVER_URL = "https://api.apexofficeprint.com/"
API_KEY = "{YOUR_API_KEY}"

# Add server
server = aop.config.Server(
    SERVER_URL,
    aop.config.ServerConfig(api_key=API_KEY)
)

# Create prinjob
printjob = aop.PrintJob(
    template=aop.Resource.from_local_file('PATH_TO_TEMPLATE'),
    data=collection,
    server=server
)

# Execute printjob and save response to file
response = printjob.execute()
response.to_file('PATH_OF_OUTPUT')
```

## Result
<img src="./imgs/hello_world_output.png" width="600" />

# Other examples
We also made some bigger examples. The current examples are:
- order_confirmation_example.py
- pdfsignature_example.py
- solar_system_example.py
- spacex_example.py
Each example also has its own folder containing the used templates, the generated output files and possibly a markdown file with explanation.

# Documentation
The documentation for this SDK can be seen by double clicking the file `index.html` in the folder `docs/apexofficeprint/`.

# Contributing

## Useful VS Code extensions
- `njpwerner.autodocstring`: Python docstring generator, uses Google-style docs by default.

## pdoc
[pdoc](https://pdoc3.github.io/pdoc/) is used for documentation generation.
Things to keep in mind when writing docs (some of these are non-standard):
- Docstrings are inherited from `super()`.
- Instance variables (attributes) can have docstrings, start the docstring on the line *underneath* the attribute
- For `@property` properties, the setter's documentation is ignored. Make sure everything is in the getter.
- You can use markdown in the docstrings, along with the generated google-style docs.
  - Doing something like \``ClassName`\` (with backticks, which are generally for inline code) makes pdoc look for the reference and try to hyperlink it in the generated docs.</br>
  This works with any object, useful methods or instance variables of a class too.
